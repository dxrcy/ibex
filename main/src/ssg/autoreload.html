<script>
    // Time the client page was loaded
    const page_loaded = Date.now() / 1000;
    // Ping server regularly 
    setInterval(ping_server, 200);
    function ping_server() {
        // File is generated by ibex::ssg
        fetch(location.origin + "/__timestamp")
            .then(res => res.text())
            .then(last_built => {
                // If files were built after this page was loaded, reload page
                if (parseInt(last_built) > page_loaded) {
                    location.reload();
                }
            })
            .catch(_err => { })
    }
</script>
